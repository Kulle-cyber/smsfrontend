<div class="manage-product-wrapper">

  <!-- Top Bar with Search and Add -->
  <div class="top-bar">
    <input
      type="text"
      placeholder="Search products..."
      [(ngModel)]="searchTerm"
      (input)="filterProducts()"
      class="search-input"
    />
    <button
      class="add-product-btn"
      (click)="showAddForm = true"
      title="Add Product"
    >
      Ôºã
    </button>
  </div>

  <!-- Total Products Count -->
  <div class="product-count">
    Total Products: {{ filteredProducts.length }}
  </div>

  <!-- Add/Edit Product Form Modal -->
  <div class="modal" *ngIf="showAddForm || editing">
    <div class="modal-content">
      <h2>{{ editing ? 'Edit Product' : 'Add Product' }}</h2>

      <form [formGroup]="productForm" (ngSubmit)="onSubmit()" autocomplete="off">
        <input
          formControlName="name"
          placeholder="Name *"
          required
          autocomplete="off"
        />
        <input
          formControlName="description"
          placeholder="Description"
          autocomplete="off"
        />
        <input
          type="number"
          formControlName="price"
          placeholder="Price *"
          required
          autocomplete="off"
        />
        <input
          type="number"
          formControlName="stock"
          placeholder="Stock *"
          required
          autocomplete="off"
        />

        <!-- File input for image -->
        <input type="file" (change)="onFileSelected($event)" accept="image/*" />
        <img
          *ngIf="imagePreview"
          [src]="imagePreview"
          alt="Preview"
          class="preview-image"
        />

        <div class="form-buttons">
          <button type="submit">{{ editing ? 'Update' : 'Add' }} Product</button>
          <button
            type="button"
            (click)="resetForm()"
            *ngIf="editing || showAddForm"
            class="cancel-btn"
          >
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Products Grid -->
  <div class="products-grid">
    <div class="product-card" *ngFor="let product of filteredProducts">
      <img [src]="product.image_url" [alt]="product.name" class="product-image" />

      <div class="product-info">
        <h3>{{ product.name }}</h3>
        <p class="description">{{ product.description }}</p>
        <p class="price-stock">
          Price: {{ product.price | currency }} | Stock: {{ product.stock }}
        </p>
        <p class="salesperson">Salesperson ID: {{ product.salesperson_id }}</p>
      </div>

      <div class="action-buttons">
        <button
          class="icon-btn edit-btn"
          (click)="editProduct(product)"
          title="Edit Product"
        >
          ‚úèÔ∏è
        </button>
        <button
          class="icon-btn delete-btn"
          (click)="deleteProduct(product.id!)"
          title="Delete Product"
        >
          üóëÔ∏è
        </button>
      </div>
    </div>
  </div>
</div>
